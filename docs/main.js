!function(e){var t={};function s(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(o,r,function(t){return e[t]}.bind(null,r));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e,t,s){},function(e,t,s){"use strict";s.r(t);class o{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector("."+s)}addItem(e){this._container.append(e)}renderItems(){this._items.forEach(e=>{this._renderer(e)})}}var r=class{constructor(e,t,s,o,r,i,n){this._card=e,this._locationTitle=e.name,this._locationLink=e.link,this._templateSelector=t,this._viewFullImage=s,this._cardID=e._id,this._deleteCardPopup=o,this._userID=r,this._handleAddLike=i,this._handleRemoveLike=n}_getTemplate(){return this._templateSelector.querySelector(".elements__list-item").cloneNode(!0)}_toggleLikedPicture(){this._likeButton.classList.contains("elements__like_liked")?this._handleRemoveLike(this._card).then(e=>{this._likeButton.classList.remove("elements__like_liked"),this._numberLikesText.textContent=e.likes.length}):this._handleAddLike(this._card).then(e=>{this._likeButton.classList.add("elements__like_liked"),this._numberLikesText.textContent=e.likes.length})}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".elements__like"),this._trashButton=this._cardElement.querySelector(".elements__trash"),this._likeButton.addEventListener("click",()=>{this._toggleLikedPicture()}),this._userID===this._card.owner._id?this._trashButton.addEventListener("click",()=>{this._deleteCardPopup(this)}):this._trashButton.remove(),this._locationImage.addEventListener("click",this._viewFullImage)}_checkIfImageIsLiked(){this._card.likes.some(e=>{this._userID===e._id?this._likeButton.classList.add("elements__like_liked"):this._likeButton.classList.remove("elements__like_liked")})}_checkHowManyLikes(){this._numberLikesText.textContent=this._card.likes.length}generateCard(){return this._cardElement=this._getTemplate(),this._locationImage=this._cardElement.querySelector(".elements__image"),this._locationName=this._cardElement.querySelector(".elements__location-name"),this._numberLikesText=this._cardElement.querySelector(".elements__number-likes"),this._locationImage.src=this._locationLink,this._locationImage.alt=this._locationTitle,this._locationName.textContent=this._locationTitle,this._setEventListeners(),this._checkIfImageIsLiked(),this._checkHowManyLikes(),this._cardElement}};var i=class{constructor(e,t){this._validationObject=e,this._form=t}_closeFormHandler(e){const t=e.querySelector(".popup__form");t.reset();const s=Array.from(t.querySelectorAll(".popup__input")),o=t.querySelector(".popup__submit");this._toggleButtonState(s,o,this._validationObject),s.forEach(e=>{this._hideInputError(t,e,this._validationObject)})}_hideInputError(e,t,s){const o=e.querySelector(`#${t.id}-error`);t.classList.remove(s.inputErrorClass),o.classList.remove(s.errorClass),o.textContent=""}_showInputError(e,t,s,o){const r=e.querySelector(`#${t.id}-error`);t.classList.add(o.inputErrorClass),r.classList.add(o.errorClass),r.textContent=s}_checkValidity(e,t,s){t.validity.valid?this._hideInputError(e,t,s):this._showInputError(e,t,t.validationMessage,s)}_hasInvalidInput(e){return e.some(e=>{if(!1===e.validity.valid)return!0})}_toggleButtonState(e,t,s){this._hasInvalidInput(e)?(t.classList.add(s.inactiveButtonClass),t.disabled=!0):(t.classList.remove(s.inactiveButtonClass),t.disabled=!1)}_setEventListeners(e,t){const s=Array.from(t.querySelectorAll(e.inputSelector)),o=t.querySelector(e.submitButtonSelector);this._toggleButtonState(s,o,e),s.forEach(r=>{r.addEventListener("input",()=>{this._checkValidity(t,r,e),this._toggleButtonState(s,o,e)})})}enableValidation(){this._form.addEventListener("submit",e=>{e.preventDefault()}),this._setEventListeners(this._validationObject,this._form)}};class n{constructor(e,t){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._formReset=t}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close").addEventListener("click",()=>{this.close()}),this._popupElement.addEventListener("click",e=>{e.target.classList.contains("popup")&&this.close()})}open(){this._popupElement.classList.add("popup_opened"),this.setEventListeners(),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscClose)}}let a={};class l extends n{constructor(e,t,s=(()=>{})){super(e),this._formSubmit=t,this._formReset=s}_getInputValues(){return this._popupForm=this._popupElement.querySelector(".popup__form"),this._inputList=Array.from(this._popupForm.querySelectorAll(".popup__input")),this._formInputs={},this._inputList.forEach(e=>{this._formInputs[e.name]=e.value.trim()}),a=this._formInputs,this._formInputs}setEventListeners(){super.setEventListeners(),this._popupElement.querySelector(".popup__form").addEventListener("submit",e=>{e.preventDefault();const t=this._popupElement.querySelector(".popup__submit");t.textContent="Saving...",this._formSubmit(this._getInputValues(),t).then(()=>{this.close()})})}open(){super.open()}close(){super.close(),this._formReset(this._popupElement)}}s(0);const _=document.querySelector(".profile__edit-button"),c=document.querySelector(".popup_type_edit").querySelector(".popup__form"),u=c.querySelector(".popup__input_type_name"),p=c.querySelector(".popup__input_type_about-me"),h=document.querySelector(".profile__add-button"),d=document.querySelector(".elements__list"),m=document.querySelector("#location-template").content,f=document.querySelector(".profile__avatar-button"),v={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inactiveButtonClass:"button_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible"},E=Array.from(document.forms),y=new i(v),k=new class extends n{constructor(e){super(e),this._imageCaption=this._popupElement.querySelector(".popup__image-caption"),this._fullSizeImage=this._popupElement.querySelector(".popup__full-size-image")}open({name:e,link:t}){super.open(),this._imageCaption.textContent=e,this._fullSizeImage.src=t}}(".popup_type_image"),g=new class{constructor({profileName:e,profileProfession:t,profileAvatar:s},o,r){this._profileName=document.querySelector(e),this._profileProfession=document.querySelector(t),this._profileAvatar=document.querySelector(s),this._nameInput=o,this._aboutMeInput=r}getUserInfo(){return{name:this._profileName.textContent,profession:this._profileProfession.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileProfession.textContent=t}setUserAvatar(e){this._profileAvatar.src=e}setUserInputValues(){this._userInfo=this.getUserInfo(),this._nameInput.value=this._userInfo.name,this._aboutMeInput.value=this._userInfo.profession}}({profileName:".profile__name",profileProfession:".profile__about-me",profileAvatar:".profile__avatar"},u,p);document.querySelector(".profile__avatar");let L;const I=new class{constructor(e,t){this._baseUrl=e,this._options=t}getUserInfo(){return this._options.method="GET",fetch(this._baseUrl+"users/me",this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).catch(e=>{console.log("logged "+e)})}getInitialCards(){return this._options.method="GET",fetch(this._baseUrl+"cards",this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).then(e=>e).catch(e=>{console.log(e)})}addNewCard(e){return this._options.method="POST",this._options.body=JSON.stringify({name:e.name,link:e.link}),fetch(this._baseUrl+"cards",this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).catch(e=>{console.log(e)})}deleteCard(e){return this._options.method="DELETE",fetch(`${this._baseUrl}cards/${e._cardID}`,this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).catch(e=>{console.log(e)})}setUserAvatar(e){return this._options.method="PATCH",this._options.body=JSON.stringify({avatar:e["profile-pic"]}),fetch(this._baseUrl+"users/me/avatar",this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).catch(e=>{console.log(e)})}setUserInfo({name:e,profession:t}){return this._options.method="PATCH",this._options.body=JSON.stringify({name:e,about:t}),fetch(this._baseUrl+"users/me",this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).catch(e=>{console.log(e)})}setLikeForImage(e){return this._options.method="PUT",fetch(`${this._baseUrl}cards/likes/${e._id}`,this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).catch(e=>{console.log(e)})}removeLikeForImage(e){return this._options.method="DELETE",fetch(`${this._baseUrl}cards/likes/${e._id}`,this._options).then(e=>{if(e.ok)return e.json();Promise.reject("Error "+e.statusText)}).catch(e=>{console.log(e)})}}("https://around.nomoreparties.co/v1/group-3/",{headers:{authorization:"0519b525-02c0-4fb8-9c6d-6c37076de85e","Content-Type":"application/json"}}),S=e=>{y._closeFormHandler(e)},b=e=>I.setLikeForImage(e),C=e=>I.removeLikeForImage(e);let q;const x=new l(".popup_type_edit",({name:e,profession:t},s)=>I.setUserInfo({name:e,profession:t}).then(()=>{s.textContent="Save",g.setUserInfo(e,t)}),S);x.setEventListeners(),_.addEventListener("click",()=>{g.setUserInputValues(),x.open()});const j=new l(".popup_type_add",(e,t)=>I.addNewCard(e).then(t=>{const s=new r(t,m,()=>{k.open(e)},e=>{P.open(),q=e},L,b,C).generateCard();d.prepend(s)}).then(()=>{t.textContent="Create"}),S);j.setEventListeners(),h.addEventListener("click",()=>{j.open()});const T=new l(".popup_type_profile-pic",(e,t)=>I.setUserAvatar(e,t).then(()=>{t.textContent="Save",g.setUserAvatar(e["profile-pic"])}),S);T.setEventListeners(),f.addEventListener("click",()=>{T.open()});const P=new l(".popup_type_delete",({},e)=>I.deleteCard(q).then(()=>{q._cardElement.remove(),e.textContent="Yes"}));P.setEventListeners(),I.getUserInfo().then(e=>{g.setUserAvatar(e.avatar),g.setUserInfo(e.name,e.about),L=e._id}),I.getInitialCards().then(e=>{const t=new o({items:e,renderer:e=>{const s=new r(e,m,()=>{k.open(e)},e=>{P.open(),q=e},L,b,C).generateCard();t.addItem(s)}},"elements__list");t.renderItems()}),E.forEach(e=>{new i(v,e).enableValidation()})}]);